# Training config

[data]
train_dir = "/mnt/imagenet/train"
val_dir = "/mnt/imagenet/val"
num_workers = 4
batch_size = 256
image_size = 224

[augment]
policy = "randaugment" # options: none, autoaugment, randaugment
randaugment_num_ops = 2
randaugment_magnitude = 9

[model]
name = "resnet50" # e.g., resnet50, vit_base_patch16_224, convnext_base
pretrained = false
num_classes = 1000

[optim]
name = "sgd"
lr = 0.1 # scale linearly: 0.1 * (batch_size / 256)
weight_decay = 0.0001

[scheduler]
name = "cosine" # options: none, cosine
max_epochs = 120
warmup_epochs = 5

[trainer]
max_epochs = 120
precision = "bf16" # options: 32, 16, bf16
devices = 1
accumulate_grad_batches = 1
seed = 0
output_dir = "/mnt/imagenet/outputs/train"
checkpoint_dir = "/mnt/imagenet/outputs/checkpoints"
log_every_n_steps = 50

[wandb]
enabled = true
project = "imagenet-training"
entity = ""
run_name = "${model.name}-bs${data.batch_size}-sz${data.image_size}"
tags = ["imagenet", "lightning"]
mode = "online" # options: online, offline, disabled